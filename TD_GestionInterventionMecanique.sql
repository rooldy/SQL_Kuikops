CREATE SCHEMA IF NOT EXISTS GESTION;

SET SEARCH_PATH TO GESTION;

BEGIN TRANSACTION;

-- Suppression des tables si elles existent déjà
DROP TABLE IF EXISTS GESTION.INTERVENANTS CASCADE;
DROP TABLE IF EXISTS GESTION.INTERVENTIONS CASCADE;
DROP TABLE IF EXISTS GESTION.VEHICULE CASCADE;
DROP TABLE IF EXISTS GESTION.MODELE CASCADE;
DROP TABLE IF EXISTS GESTION.MARQUE CASCADE;
DROP TABLE IF EXISTS GESTION.EMPLOYE CASCADE;
DROP TABLE IF EXISTS GESTION.CLIENT CASCADE;

-- Création des tables
CREATE TABLE GESTION.CLIENT(
	NUMCLIENT INTEGER,
	CIV VARCHAR(5),
	PRENOMCLIENT VARCHAR(50),
	NOMCLIENT VARCHAR(50),
	DATENAISSANCE DATE,
	ADRESSE VARCHAR(100),
	TELPROF VARCHAR(20),
	TELPRIV VARCHAR(20),
	FAX VARCHAR(20),
	CONSTRAINT PK_CLIENT PRIMARY KEY (NUMCLIENT)
);

CREATE TABLE GESTION.EMPLOYE(
	NUMEMPLOYE INTEGER, 
	NOMEMP VARCHAR(50), 
	PRENOMEMP VARCHAR(50), 
	CATEGORIE VARCHAR(20), 
	SALAIRE DECIMAL(20,9),
	CONSTRAINT PK_EMPLOYE PRIMARY KEY (NUMEMPLOYE)
);

CREATE TABLE GESTION.MARQUE (
	NUMMARQUE INTEGER, 
	MARQUE VARCHAR(20), 
	PAYS VARCHAR(20),
	CONSTRAINT PK_MARQUE PRIMARY KEY (NUMMARQUE)
);
	
CREATE TABLE GESTION.MODELE (
	NUMMODELE INTEGER, 
	NUMMARQUE INTEGER, 
	MODELE VARCHAR(20),
	CONSTRAINT PK_NUMMODELE PRIMARY KEY (NUMMODELE),
	CONSTRAINT FK_MARQUE FOREIGN KEY (NUMMARQUE) REFERENCES GESTION.MARQUE(NUMMARQUE)
);

CREATE TABLE GESTION.VEHICULE (
	NUMVEHICULE INTEGER, 
	NUMCLIENT INTEGER, 
	NUMMODELE INTEGER, 
	NUMIMMAT VARCHAR(20), 
	ANNEE INTEGER,  -- Changement du type de données
	CONSTRAINT PK_NUMVEHICULE PRIMARY KEY (NUMVEHICULE),
	CONSTRAINT FK_NUMCLIENT FOREIGN KEY (NUMCLIENT) REFERENCES GESTION.CLIENT(NUMCLIENT),
	CONSTRAINT FK_NUMMODELE FOREIGN KEY (NUMMODELE) REFERENCES GESTION.MODELE(NUMMODELE)
);

CREATE TABLE GESTION.INTERVENTIONS (
	NUMINTERVENTION INTEGER, 
	NUMVEHICULE INTEGER, 
	TYPEINTERVENTION VARCHAR(20), 
	DATEDEBINTERV TIMESTAMP,
	DATEFININTERV TIMESTAMP, 
	COUTINTERV DECIMAL(20,9),  -- Changement du type de données
	CONSTRAINT PK_NUMINTERVENTION PRIMARY KEY (NUMINTERVENTION),
	CONSTRAINT FK_NUMVEHICULE FOREIGN KEY (NUMVEHICULE) REFERENCES GESTION.VEHICULE(NUMVEHICULE)
);

CREATE TABLE GESTION.INTERVENANTS (
	NUMINTERVENTION INTEGER,
	NUMEMPLOYE INTEGER, 
	DATEDEBUT TIMESTAMP, 
	DATEFIN TIMESTAMP,
	CONSTRAINT PK_INTERVENANTS PRIMARY KEY (NUMINTERVENTION, NUMEMPLOYE),  -- Clé primaire composée
	CONSTRAINT FK_NUMEMPLOYE FOREIGN KEY (NUMEMPLOYE) REFERENCES GESTION.EMPLOYE(NUMEMPLOYE),
	CONSTRAINT FK_NUMINTERVENTION FOREIGN KEY (NUMINTERVENTION) REFERENCES GESTION.INTERVENTIONS(NUMINTERVENTION)
);

-- Pou afficher mes tables dans ma base de données

SELECT table_name 
FROM information_schema.tables 
WHERE table_schema = 'gestion' 
  AND table_type = 'BASE TABLE';


-- Insertion dans la table client check

INSERT INTO GESTION.CLIENT (NUMCLIENT, CIV, PRENOMCLIENT, NOMCLIENT, DATENAISSANCE, ADRESSE, TELPROF, TELPRIV, FAX) VALUES 
(1, 'Mme', 'Cherifa', 'MAHBOUBA', '1957-08-08', 'CITE 1013 LOGTS BT 61 Alger', '0561381813', '0562458714', NULL),
(2, 'Mme', 'Lamia', 'TAHMI', '1955-12-31', 'CITE BACHEDJARAH BATIMENT 38 -Bach Djerrah-Alger', '0562467849', '0561392487', NULL),
(3, 'Mle', 'Ghania ', 'DIAF AMROUNI', '1955-12-31', '43, RUE ABDERRAHMANE SBAA BELLE VUE-EL HARRACH-ALGER', '0523894562', '0619430945', '0562784254'),
(4, 'Mle', 'Chahinaz', 'MELEK', '1955-06-27', 'HLM AISSAT IDIR CAGE 9 3EME ETAGE-EL HARRACH ALGER', '0634613493', '0562529463', NULL),
(5, 'Mme', 'Noura', 'TECHTACHE', '1949-03-22', '16, ROUTE EL DJAMILA-AIN BENIAN-ALGER', '0562757834', NULL, '0562757843'),
(6, 'Mme', 'Widad', 'TOUATI', '1965-08-14', '14 RUE DES FRERES AOUDIA-EL MOURADIA-ALGER', '0561243967', '0561401836', NULL),
(7, 'Mle', 'Faiza', 'ABLOUL', '1967-10-28', 'CITE DIPLOMATIQUE BT BLEU 14B N 3 DERGANA- ALGER', '0562935427', '0561486203', NULL),
(8, 'Mme', 'Assia', 'HORRA', '1963-12-08', '32 RUE AHMED OUAKED-DELY BRAHIM-ALGER', '0561038500', NULL, '0562466733'),
(9, 'Mle', 'Souad', 'MESBAH', '1972-08-30', 'RESIDENCE CHABANI-HYDRA-ALGER', '0561024358', NULL, NULL),
(10, 'Mme', 'Houda', 'GROUDA', '1950-02-20', 'EPSP THNIET ELABED BATNA', '0562939495', '0561218456', NULL),
(11, 'Mle', 'Saida', 'FENNICHE', NULL, 'CITE DE L’INDEPENDANCE LARBAA BLIDA', '0645983165', '0562014784', NULL),
(12, 'Mme', 'Samia', 'OUALI', '1966-11-17', 'CITE 200 LOGEMENTS BT1 N1-JIJEL', '0561374812', '0561277013', NULL),
(13, 'Mme', 'Fatiha', 'HADDAD', '1980-09-20', 'RUE BOUFADA LAKHDARAT-AIN OULMANE-SETIF', '0647092453', '0562442700', NULL),
(14, 'M', 'Djamel', 'MATI', NULL, 'DRAA KEBILA HAMMAM GUERGOUR SETIF', '0561033663', '0561484259', NULL),
(15, 'M', 'Mohamed', 'GHRAIR', '1950-06-24', 'CITE JEANNE D’ARC ECRAN B5-GAMBETTA – ORAN', '0561390288', NULL, '0562375849'),
(16, 'M', 'Ali', 'LAAOUAR', NULL, 'CITE 1ER MAI EX 137 LOGEMENTS-ADRAR', '0639939410', '0561255412', NULL),
(17, 'M', 'Messoud', 'AOUIZ', '1958-11-24', 'RUE SAIDANI ABDESSLAM -AIN BESSEM-BOUIRA', '0561439256', '0561473625', NULL),
(18, 'M', 'Farid', 'AKIL', '1961-05-06', '3 RUE LARBI BEN MHIDI-DRAA EL MIZAN-TIZI OUZOU', '0562349254', '0561294268', NULL),
(19, 'Mme', 'Dalila', 'MOUHTADI', NULL, '6, BD TRIPOLI ORAN', '0506271459', '0506294186', NULL),
(20, 'M', 'Younes', 'CHALAH', NULL, 'CITE DES 60 LOGTS BT D N 48-NACIRIA-BOUMERDES', NULL, '0561358279', NULL),
(21, 'M', 'Boubeker', 'BARKAT', '1935-11-08', 'CITE MENTOURI N 71 BT AB SMK Constantine', '0561824538', '0561326179', NULL),
(22, 'M', 'Seddik', 'HMIA', NULL, '25 RUE BEN YAHIYA-JIJEL', '0562379513', NULL, '0562493627'),
(23, 'M', 'Lamine', 'MERABAT', '1965-09-13', 'CITE JEANNE D’ARC ECRAN B2-GAMBETTA – ORAN', '0561724538', '0561724538', NULL);


--- Insertion dans la table employe check

INSERT INTO EMPLOYE VALUES 
(53, 'LACHEMI', 'Bouzid', 'Mecanicien', 25000),
(54, 'BOUCHEMLA', 'Elias', 'Assistant', 10000),
(55, 'HADJ', 'Zouhir', 'Assistant', 12000),
(56, 'OUSSEDIK', 'Hakim', 'Mecanicien', 20000),
(57, 'ABAD', 'Abdelhamid', 'Assistant', 13000),
(58, 'BABACI', 'Tayeb', 'Mecanicien', 21300),
(59, 'BELHAMIDI', 'Mourad', 'Mecanicien', 19500),
(60, 'IGOUDJIL', 'Redouane', 'Assistant', 15000),
(61, 'KOULA', 'Bahim', 'Mecanicien', 23100),
(62, 'RAHALI', 'Ahcene', 'Mecanicien', 24000),
(63, 'CHAOUI', 'Ismail', 'Assistant', 13000),
(64, 'BADI', 'Hatem', 'Assistant', 14000),
(65, 'MOHAMMEDI', 'Mustapha', 'Mecanicien', 24000),
(66, 'FEKAR', 'Abdelaziz', 'Assistant', 13500),
(67, 'SAIDOUNI', 'Wahid', 'Mecanicien', 25000),
(68, 'BOULARAS', 'Farid', 'Assistant', 14000),
(69, 'CHAKER', 'Nassim', 'Mecanicien', 26000),
(71, 'TERKI', 'Yacine', 'Mecanicien', 23000),
(72, 'TEBIBEL', 'Ahmed', 'Assistant', 17000),
(80, 'LARDJOUNE', 'Karim', 'Assistant', 25000);

-- Insertion dans la table intervenant

INSERT INTO INTERVENANTS VALUES
(1, 54, '2006-02-26 09:00:00', '2006-02-26 12:00:00'),
(1, 59, '2006-02-25 09:00:00', '2006-02-25 18:00:00'),
(2, 57, '2006-02-24 14:00:00', '2006-02-24 18:00:00'),
(2, 59, '2006-02-23 09:00:00', '2006-02-24 12:00:00'),
(3, 60, '2006-04-09 09:00:00', '2006-04-09 12:00:00'),
(3, 65, '2006-04-06 14:00:00', '2006-04-08 18:00:00'),
(5, 56, '2006-02-22 09:00:00', '2006-02-25 12:00:00'),
(5, 60, '2006-02-23 09:00:00', '2006-02-25 18:00:00'),
(6, 53, '2006-03-03 14:00:00', '2006-03-04 12:00:00'),
(6, 57, '2006-03-04 14:00:00', '2006-03-04 18:00:00'),
(8, 54, '2006-05-12 09:00:00', '2006-05-12 18:00:00'),
(8, 62, '2006-05-11 14:00:00', '2006-05-12 12:00:00'),
(10, 63, '2006-04-09 14:00:00', '2006-04-09 18:00:00'),
(10, 67, '2006-04-08 09:00:00', '2006-04-09 12:00:00'),
(11, 59, '2006-03-09 09:00:00', '2006-03-11 18:00:00'),
(11, 64, '2006-03-09 09:00:00', '2006-03-17 12:00:00'),
(11, 53, '2006-03-08 14:00:00', '2006-03-16 18:00:00'),
(12, 55, '2006-05-05 09:00:00', '2006-05-05 18:00:00'),
(12, 56, '2006-05-03 09:00:00', '2006-05-05 12:00:00');

-- Insertion dans la table intervention

ALTER TABLE GESTION.INTERVENTIONS
ALTER COLUMN TYPEINTERVENTION TYPE VARCHAR(50);


INSERT INTO INTERVENTIONS VALUES 
(1, 3, 'Réparation', '2006-02-25 09:00:00', '2006-02-26 12:00:00', 30000),
(2, 21, 'Réparation', '2006-02-23 09:00:00', '2006-02-24 18:00:00', 10000),
(3, 25, 'Réparation', '2006-04-06 14:00:00', '2006-04-09 12:00:00', 42000),
(5, 6, 'Réparation', '2006-02-22 09:00:00', '2006-02-25 18:00:00', 40000),
(6, 14, 'Entretien', '2006-03-03 14:00:00', '2006-03-04 18:00:00', 7500),
(8, 17, 'Entretien', '2006-05-11 14:00:00', '2006-05-12 18:00:00', 9000),
(10, 2, 'Entretien et Réparation', '2006-04-08 09:00:00', '2006-04-09 18:00:00', 45000),
(11, 28, 'Réparation', '2006-03-08 14:00:00', '2006-03-17 12:00:00', 36000),
(12, 20, 'Entretien et Réparation', '2006-05-03 09:00:00', '2006-05-05 18:00:00', 27000),
(14, 1, 'Réparation', '2006-05-10 14:00:00', '2006-05-12 12:00:00', 39000);

-- Insertion dans la table marque check

INSERT INTO MARQUE VALUES
(1, 'LAMBORGHINI', 'ITALIE'),
(2, 'AUDI', 'ALLEMAGNE'),
(3, 'ROLLS-ROYCE', 'GRANDE-BRETAGNE'),
(4, 'BMW', 'ALLEMAGNE'),
(5, 'CADILLAC', 'ETATS-UNIS'),
(6, 'CHRYSLER', 'ETATS-UNIS'),
(7, 'FERRARI', 'ITALIE'),
(8, 'HONDA', 'JAPON'),
(9, 'JAGUAR', 'GRANDE-BRETAGNE'),
(10, 'ALFA-ROMEO', 'ITALIE'),
(11, 'LEXUS', 'JAPON'),
(12, 'LOTUS', 'GRANDE-BRETAGNE'),
(13, 'MASERATI', 'ITALIE'),
(14, 'MERCEDES', 'ALLEMAGNE'),
(15, 'PEUGEOT', 'FRANCE'),
(16, 'PORSCHE', 'ALLEMAGNE'),
(17, 'RENAULT', 'FRANCE'),
(18, 'SAAB', 'SUEDE'),
(19, 'TOYOTA', 'JAPON'),
(20, 'VENTURI', 'FRANCE'),
(21, 'VOLVO', 'SUEDE');

-- Insertion dans la table modele check

INSERT INTO MODELE VALUES
(2, 1, 'Diablo'),
(3, 2, 'Série 5'),
(4, 10, 'NSX'),
(5, 14, 'Classe C'),
(6, 17, 'Safrane'),
(7, 20, '400 GT'),
(8, 12, 'Esprit'),
(9, 15, '605'),
(10, 19, 'Prévia'),
(11, 7, '550 Maranello'),
(12, 3, 'Bentley-Continental'),
(13, 10, 'Spider'),
(14, 13, 'Evoluzione'),
(15, 16, 'Carrera'),
(16, 16, 'Boxter'),
(17, 21, 'S 80'),
(18, 6, '300 M'),
(19, 4, 'M 3'),
(20, 9, 'XJ 8'),
(21, 15, '406 Coupé'),
(22, 20, '300 Atlantic'),
(23, 14, 'Classe E'),
(24, 11, 'GS 300'),
(25, 5, 'Séville'),
(26, 18, '95 Cabriolet'),
(27, 2, 'TT Coupé'),
(28, 7, 'F 355');

-- Insertion dans la table vehicule check

INSERT INTO VEHICULE VALUES 
(1, 2, 6, '0012519216', 1992),
(2, 9, 20, '0124219316', 1993),
(3, 17, 8, '1452318716', 1987),
(4, 6, 12, '3145219816', 1998),
(5, 16, 23, '1278919816', 1998),
(6, 20, 6, '3853319735', 1997),
(7, 7, 8, '1453119816', 1998),
(8, 16, 14, '8365318601', 1986),
(9, 13, 15, '3087319233', 1992),
(10, 20, 22, '9413119935', 1999),
(11, 9, 16, '1572319801', 1998),
(12, 14, 20, '6025319733', 1997),
(13, 19, 17, '5205319736', 1997),
(14, 22, 21, '7543119207', 1992),
(15, 4, 19, '6254319916', 1999),
(16, 16, 21, '9831419701', 1997),
(17, 12, 11, '4563117607', 1976),
(18, 1, 2, '7973318216', 1982),
(20, 22, 2, '1234319707', 1997),
(21, 3, 19, '8429318516', 1985),
(22, 8, 19, '1245619816', 1998),
(23, 7, 25, '1678918516', 1985),
(25, 13, 5, '1278919833', 1998),
(26, 3, 10, '1458919316', 1993),
(27, 10, 7, '1256019804', 1998),
(28, 10, 3, '1986219904', 1999);

COMMIT;

-- 1-Créer deux TableSpaces INTERVENTION_TBS et INTERVENTION_TempTBS

CREATE TABLESPACE intervention_tbs 
LOCATION '/Users/rooldyalphonse/Desktop/KuikOPs/SQL/INTERVENTION_TBS';


CREATE TEMPORARY TABLESPACE INTERVENTION_TempTBS 
TEMPFILE '/Users/rooldyalphonse/Desktop/KuikOPs/SQL/INTERVENTION_TempTBS.dat' SIZE 100M 
AUTOEXTEND ON;

CREATE USER Rooldy 
IDENTIFIED BY 'MotDePasse' 
DEFAULT TABLESPACE INTERVENTION_TBS
TEMPORARY TABLESPACE INTERVENTION_TempTBS;


GRANT ALL PRIVILEGES ON DATABASE GestionInterventionsMecaniques TO Rooldy;

CREATE USER DBAINTERVENTION
IDENTIFIED BY '$Alfonso1990@@##' 
DEFAULT TABLESPACE INTERVENTION_TBS 
TEMPORARY TABLESPACE INTERVENTION_TempTBS;

-- Ajouter l’attribut DATEINSTALLATION de type Date dans la relation EMPLOYE.
ALTER TABLE GESTION.EMPLOYE
ADD DATEINSTALLATION DATE;

-- Ajouter la contrainte not null pour les attributs CATEGORIE, SALAIRE de la relation EMPLOYE.
ALTER TABLE GESTION.EMPLOYE
ALTER COLUMN CATEGORIE SET NOT NULL,
ALTER COLUMN SALAIRE SET NOT NULL;

-- Modifier la longueur de l’attribut PRENOMEMP (agrandir, réduire).
ALTER TABLE GESTION.EMPLOYE
ALTER COLUMN PRENOMEMP TYPE VARCHAR(100);
-- OU RÉDUIRE
ALTER TABLE EMPLOYE
ALTER COLUMN PRENOMEMP TYPE VARCHAR(30);


-- Supprimer la colonne DATEINSTALLATION dans la table EMPLOYE. Vérifier la suppression.

ALTER TABLE GESTION.EMPLOYE
DROP COLUMN DATEINSTALLATION;


-- Renommer la colonne ADRESSE dans la table CLIENT par ADRESSECLIENT. Vérifier.

ALTER TABLE GESTION.CLIENT
RENAME COLUMN ADRESSE TO ADRESSECLIENT;

SELECT ADRESSECLIENT FROM GESTION.CLIENT;

-- Ajouter la contrainte suivante : Date de début d’intervention doit être inferieur à la date de fin
-- d’intervention.

ALTER TABLE GESTION.INTERVENTIONS
ADD CONSTRAINT chk_dates
CHECK (DATEDEBINTERV < DATEFININTERV);

-- VÉRIFICATION DE LA CONTRAINTE

INSERT INTO GESTION.INTERVENTIONS (NUMINTERVENTION, NUMVEHICULE, TYPEINTERVENTION, DATEDEBINTERV, DATEFININTERV, COUTINTERV)
VALUES (13, 5, 'Réparation', '2023-01-01 09:00:00', '2022-12-31 18:00:00', 25000);

-- Remplir toutes les tables par les instances représentées ci-dessus, quels sont les problèmes rencontrés.

-- Exemple de commandes d'insertion pour vérifier les problèmes rencontrés

-- Insérer des données dans une table de référence (par exemple, CLIENTS)
INSERT INTO GESTION.CLIENT (NUMCLIENT, NOMCLIENT, ADRESSECLIENT) VALUES
(1, 'Dupont', '10 rue des Fleurs'),
(2, 'Martin', '15 avenue des Champs');

-- DUPLICATE KEY VALUE
-- Contrainte NOT NULL
-- Longueur des chaînes de caractères
-- Types de données incompatibles
-- Contrainte CHECK

-- Insérer des données dans une table dépendante (par exemple, INTERVENTIONS)
INSERT INTO INTERVENTIONS (NUMINTERVENTION, NUMVEHICULE, TYPEINTERVENTION, DATEDEBINTERV, DATEFININTERV, COUTINTERV) VALUES
(1, 1, 'Réparation', '2023-01-01 09:00:00', '2023-01-02 18:00:00', 30000),
(2, 2, 'Entretien', '2023-01-03 09:00:00', '2023-01-04 18:00:00', 15000);

-- Supposons que le salaire de l’employé BADI Hatem est augmenté par 5000DA Que faut-il faire ?
-- 1
SELECT NOMEMP, PRENOMEMP, SALAIRE
FROM GESTION.EMPLOYE
WHERE NOMEMP = 'BADI' AND PRENOMEMP = 'Hatem';

-- 2
UPDATE GESTION.EMPLOYE
SET SALAIRE = SALAIRE + 5000
WHERE NOMEMP = 'BADI' AND PRENOMEMP = 'Hatem';

-- 3
SELECT NOMEMP, PRENOMEMP, SALAIRE
FROM GESTION.EMPLOYE
WHERE NOMEMP = 'BADI' AND PRENOMEMP = 'Hatem';

-- Pour les interventions de mois de Février, ajouter 5 cinq jours à la date de début. Désactiver la contrainte
-- pour autoriser la modification. Réactiver la contrainte.
-- Désactiver la contrainte sur les dates

ALTER TABLE GESTION.INTERVENTIONS DROP CONSTRAINT PK_NUMINTERVENTION CASCADE;

-- Ajouter 5 jours à la date de début pour toutes les interventions de Février
ALTER TABLE GESTION.INTERVENTIONS
DISABLE CONSTRAINT chk_dates;

ALTER TABLE GESTION.INTERVENTIONS
DROP CONSTRAINT chk_dates;

UPDATE GESTION.INTERVENTIONS
SET DATEDEBINTERV = DATEDEBINTERV + INTERVAL '5 days'
WHERE EXTRACT(MONTH FROM DATEDEBINTERV) = 2;

-- Vérification
SELECT *
FROM GESTION.INTERVENTIONS
WHERE EXTRACT(MONTH FROM DATEDEBINTERV) = 2;

UPDATE GESTION.INTERVENTIONS
SET DATEFININTERV = DATEDEBINTERV + INTERVAL '1 day'
WHERE DATEDEBINTERV > DATEFININTERV;

-- Réactiver la contrainte (Recréer la contrainte)
ALTER TABLE GESTION.INTERVENTIONS
ADD CONSTRAINT chk_dates
CHECK (DATEDEBINTERV < DATEFININTERV);

-- Supprimer toutes les véhicules de modèle Série 5. Quels sont les problèmes rencontrés.

DELETE FROM GESTION.MODELE
WHERE MODELE = 'SERIE 5';

-- PROBLÈMES 
-- Violations de contrainte de clé étrangère :
-- 

select * from gestion.vehicule;

-- Lister les modèles et leur marque.

SELECT m.MODELE, ma.MARQUE
FROM GESTION.MODELE m
JOIN GESTION.MARQUE ma ON m.nummarque = ma.nummarque;

-- Lister les véhicules sur lesquels, il y a au moins une intervention.

SELECT DISTINCT v.numvehicule, i.typeintervention
FROM GESTION.VEHICULE v
INNER JOIN GESTION.INTERVENTIONS i ON v.numvehicule = i.numvehicule;

-- Quelle est la durée moyenne d’une intervention?

SELECT AVG(EXTRACT(EPOCH FROM (DATEFININTERV - DATEDEBINTERV)) / 3600) AS DUREE_MOYENNE_HORAIRES
FROM GESTION.INTERVENTIONS;

-- Donner le montant global des interventions dont le coût d’intervention est supérieur à 30000 DA?

SELECT SUM(COUTINTERV) AS MONTANT_GLOBAL
FROM GESTION.INTERVENTIONS
WHERE COUTINTERV > 30000;













